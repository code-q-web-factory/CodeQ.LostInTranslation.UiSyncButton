(()=>{var ke=Object.create;var E=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var Pe=Object.getOwnPropertyNames;var Ue=Object.getPrototypeOf,Be=Object.prototype.hasOwnProperty;var a=(e,o)=>()=>(e&&(o=e(e=0)),o);var d=(e,o)=>()=>(o||e((o={exports:{}}).exports,o),o.exports);var v=(e,o,t,r)=>{if(o&&typeof o=="object"||typeof o=="function")for(let n of Pe(o))!Be.call(e,n)&&n!==t&&E(e,n,{get:()=>o[n],enumerable:!(r=w(o,n))||r.enumerable});return e};var i=(e,o,t)=>(t=e!=null?ke(Ue(e)):{},v(o||!e||!e.__esModule?E(t,"default",{value:e,enumerable:!0}):t,e)),Re=e=>v(E({},"__esModule",{value:!0}),e),M=(e,o,t,r)=>{for(var n=r>1?void 0:r?w(o,t):o,A=e.length-1,x;A>=0;A--)(x=e[A])&&(n=(r?x(o,t,n):x(n))||n);return r&&n&&E(o,t,n),n};var F=a(()=>{});var j=a(()=>{F()});function s(e){return(...o)=>{if(window["@Neos:HostPluginAPI"]&&window["@Neos:HostPluginAPI"][`@${e}`])return window["@Neos:HostPluginAPI"][`@${e}`](...o);throw new Error("You are trying to read from a consumer api that hasn't been initialized yet!")}}var c=a(()=>{});var q=a(()=>{});var Q=a(()=>{});var I=a(()=>{q();Q()});var Y=a(()=>{I()});var K=a(()=>{I();Y()});var V,H=a(()=>{j();c();K();V=s("manifest")});var k=d((yt,$)=>{c();$.exports=s("vendor")().React});var P=d((ht,z)=>{c();z.exports=s("vendor")().PropTypes});var U=d((Ct,J)=>{c();J.exports=s("NeosProjectPackages")().ReactUiComponents});var B=d((_t,X)=>{c();X.exports=s("vendor")().reactRedux});var ee=d((Tt,Z)=>{c();Z.exports=s("vendor")().classnames});var te=a(()=>{});var oe,ne=a(()=>{te();oe={secondaryToolbar__buttonLink:"codeq-D7NE5q_secondaryToolbar__buttonLink"}});var R=d((xt,re)=>{c();re.exports=s("NeosProjectPackages")().NeosUiDecorators});var ae=d((kt,se)=>{c();se.exports=s("vendor")().reduxActions});var m,u,we,ve,Fe,je,qe,Qe,g,ie,_=a(()=>{m=i(ae()),u={TOGGLE_SYNC_MODAL:"CodeQ.LostInTranslation.UiSyncButton/TOGGLE_SYNC_MODAL",TOGGLE_SYNC_MODAL_LOADING:"CodeQ.LostInTranslation.UiSyncButton/TOGGLE_SYNC_MODAL_LOADING",SET_SELECTED_SOURCE_LANGUAGE:"CodeQ.LostInTranslation.UiSyncButton/SET_SELECTED_SOURCE_LANGUAGE",SET_CONFIRM:"CodeQ.LostInTranslation.UiSyncButton/SET_CONFIRM",TRANSLATE_DOCUMENT:"CodeQ.LostInTranslation.UiSyncButton/TRANSLATE_DOCUMENT",RESET_SYNC_MODAL:"CodeQ.LostInTranslation.UiSyncButton/RESET_MODAL"},we=(0,m.createAction)(u.TOGGLE_SYNC_MODAL),ve=(0,m.createAction)(u.TOGGLE_SYNC_MODAL_LOADING),Fe=(0,m.createAction)(u.TRANSLATE_DOCUMENT),je=(0,m.createAction)(u.RESET_SYNC_MODAL),qe=(0,m.createAction)(u.SET_SELECTED_SOURCE_LANGUAGE),Qe=(0,m.createAction)(u.SET_CONFIRM),g={toggleSyncModal:we,toggleSyncModalLoading:ve,translateDocument:Fe,resetSyncModal:je,setSelectedSourceLanguage:qe,setConfirm:Qe},ie=(0,m.handleActions)({[u.SET_SELECTED_SOURCE_LANGUAGE]:(e,o)=>({...e,plugins:{...e?.plugins,translationSyncModal:{...e?.plugins?.translationSyncModal,selectedSourceLanguage:o.payload}}}),[u.SET_CONFIRM]:(e,o)=>({...e,plugins:{...e?.plugins,translationSyncModal:{...e?.plugins?.translationSyncModal,confirm:o.payload}}}),[u.TOGGLE_SYNC_MODAL]:(e,o)=>({...e,plugins:{...e?.plugins,translationSyncModal:{...e.plugins?.translationSyncModal,open:o.payload!==void 0?o.payload.open:!e.plugins?.translationSyncModal?.open}}}),[u.TOGGLE_SYNC_MODAL_LOADING]:(e,o)=>({...e,plugins:{...e?.plugins,translationSyncModal:{...e.plugins?.translationSyncModal,loading:o.payload!==void 0?o.payload.loading:!e.plugins?.translationSyncModal?.loading}}}),[u.RESET_SYNC_MODAL]:(e,o)=>({...e,plugins:{...e?.plugins,translationSyncModal:{open:!1,loading:!1,selectedSourceLanguage:null,confirm:!1}}})},{plugins:{translationSyncModal:{open:!1,loading:!1,selectedSourceLanguage:null,confirm:!1}}})});var G=d((Bt,le)=>{c();le.exports=s("vendor")().plow});var O,b,ce,ue,de,ge,T,S,pe=a(()=>{O=i(k()),b=i(P()),ce=i(U()),ue=i(B()),de=i(ee());ne();ge=i(R());_();T=i(G()),S=class extends O.PureComponent{constructor(){super(...arguments);this.isInTranslatableLanguage=()=>{try{let{currentDocumentNodePath:t,languages:r}=this.props,n=t.match(/(language=)[a-z]+;?/)[0];return n=n.replace("language=","").replace(";",""),r[n]?.options?.translationStrategy==="once"}catch{return!1}};this.handleClick=()=>{let{toggleAction:t}=this.props;t({open:!0})}}render(){let{i18nRegistry:t}=this.props,r=(0,de.default)({[oe.secondaryToolbar__buttonLink]:!0});return O.default.createElement(ce.IconButton,{icon:"globe",className:r,onClick:this.handleClick,"aria-label":t.translate("CodeQ.LostInTranslation.UiSyncButton:Main:translate","Translate"),title:t.translate("CodeQ.LostInTranslation.UiSyncButton:Main:translate","Translate"),disabled:!this.isInTranslatableLanguage()})}};S.propTypes={toggleAction:b.default.func,i18nRegistry:b.default.object.isRequired,languages:b.default.object,currentDocumentNodePath:b.default.string},S=M([(0,ge.neos)(e=>({i18nRegistry:e.get("i18n")})),(0,ue.connect)((0,T.$transform)({languages:(0,T.$get)("cr.contentDimensions.byName.language.presets"),currentDocumentNodePath:(0,T.$get)("cr.nodes.documentNode")}),{toggleAction:g.toggleSyncModal})],S)});var me=d((jt,fe)=>{c();fe.exports=s("NeosProjectPackages")().NeosUiI18n});var ye=a(()=>{});var N,Se=a(()=>{ye();N={confirm__label:"codeq-nlVfeG_confirm__label",body:"codeq-nlVfeG_body",select__label:"codeq-nlVfeG_select__label",foobar:"codeq-nlVfeG_foobar",select:"codeq-nlVfeG_select"}});var l,he,y,f,p,Le,C,h,Ce=a(()=>{l=i(k()),he=i(B());_();y=i(G()),f=i(U()),p=i(P()),Le=i(R()),C=i(me());Se();h=class extends l.PureComponent{constructor(){super(...arguments);this.getAvailableSourceLanguages=()=>{let{availableLanguages:t}=this.props;return t=Object.entries(t||{}).filter(([r,n])=>n?.options?.translationStrategy!=="once"&&n?.options?.translationStrategy!=="sync"),t.map(([r,n])=>({value:r,label:n.label}))};this.setConfirm=t=>{let{setConfirmAction:r}=this.props;r(t)};this.setSourceLanguage=t=>{let{setSelectedSourceLanguageAction:r}=this.props;r(t)};this.handleBack=()=>{let{resetAction:t,isLoading:r}=this.props;r||t()};this.handleTranslate=()=>{let{translateDocumentAction:t,currentDocumentNodePath:r,selectedSourceLanguage:n}=this.props;t({nodeContextPath:r,sourceLanguage:n})}}renderTitle(){return l.default.createElement(C.default,{id:"CodeQ.LostInTranslation.UiSyncButton:Main:translateDocument",fallback:"Translate document"})}renderBackAction(){let{isLoading:t}=this.props;return l.default.createElement(f.Button,{id:"codeq-lostInTranslation-uiSyncButton-dialog-Back",key:"back",style:"lighter",hoverStyle:"brand",onClick:this.handleBack,disabled:t},l.default.createElement(C.default,{id:"Neos.Neos:Main:back",fallback:"Back"}))}renderTranslateAction(){let{confirmed:t,selectedSourceLanguage:r,isLoading:n}=this.props;return l.default.createElement(f.Button,{id:"codeq-lostInTranslation-uiSyncButton-dialog-Translate",key:"translate",style:"success",hoverStyle:"brand",onClick:this.handleTranslate,disabled:!t||!r||n},l.default.createElement(C.default,{id:"CodeQ.LostInTranslation.UiSyncButton:Main:translate",fallback:"Translate"}))}renderSourceLanguageSelectBox(){let{i18nRegistry:t,selectedSourceLanguage:r,isLoading:n}=this.props;return l.default.createElement("div",{className:N.select},l.default.createElement(C.default,{id:"CodeQ.LostInTranslation.UiSyncButton:Main:sourceLanguage",fallback:"Source language",className:N.select__label}),l.default.createElement(f.SelectBox,{options:this.getAvailableSourceLanguages(),value:r,onValueChange:this.setSourceLanguage,placeholderIcon:"language",placeholder:t.translate("CodeQ.LostInTranslation.UiSyncButton:Main:chooseLanguage","Please select a language\u2026"),disabled:n}))}render(){let{isOpen:t,isLoading:r,confirmed:n}=this.props;return t?l.default.createElement(f.Dialog,{actions:[this.renderBackAction(),this.renderTranslateAction()],title:this.renderTitle(),onRequestClose:this.handleBack,type:"success",isOpen:!0},l.default.createElement("div",{className:N.body},this.renderSourceLanguageSelectBox(),l.default.createElement(f.Label,{className:N.confirm__label},l.default.createElement(f.CheckBox,{isChecked:n,disabled:r,onChange:this.setConfirm}),l.default.createElement(C.default,{id:"CodeQ.LostInTranslation.UiSyncButton:Main:confirmDeletingOfCurrentContent"})))):null}};h.propTypes={isOpen:p.default.bool.isRequired,resetAction:p.default.func.isRequired,setSelectedSourceLanguageAction:p.default.func.isRequired,setConfirmAction:p.default.func.isRequired,translateDocumentAction:p.default.func.isRequired,i18nRegistry:p.default.object.isRequired,currentDocumentNodePath:p.default.string,confirmed:p.default.bool,selectedSourceLanguage:p.default.string,toggleLoading:p.default.func.isRequired},h=M([(0,Le.neos)(e=>({i18nRegistry:e.get("i18n")})),(0,he.connect)((0,y.$transform)({isOpen:(0,y.$get)("plugins.translationSyncModal.open"),isLoading:(0,y.$get)("plugins.translationSyncModal.loading"),selectedSourceLanguage:(0,y.$get)("plugins.translationSyncModal.selectedSourceLanguage"),confirmed:(0,y.$get)("plugins.translationSyncModal.confirm"),availableLanguages:(0,y.$get)("cr.contentDimensions.byName.language.presets"),currentDocumentNodePath:(0,y.$get)("cr.nodes.documentNode")}),{setSelectedSourceLanguageAction:g.setSelectedSourceLanguage,setConfirmAction:g.setConfirm,resetAction:g.resetSyncModal,translateDocumentAction:g.translateDocument,toggleLoading:g.toggleSyncModalLoading})],h)});var _e=d((Xt,Ae)=>{c();Ae.exports=s("vendor")().reduxSagaEffects});var Te=d((eo,be)=>{c();be.exports=s("NeosProjectPackages")().NeosUiReduxStore});var oo,D,Ne=a(()=>{c();oo=s("NeosProjectPackages")().NeosUiBackendConnectorDefault,{fetchWithErrorHandling:D}=s("NeosProjectPackages")().NeosUiBackendConnector});var Ee,Me=a(()=>{Ne();Ee=e=>({translate:(t,r)=>D.withCsrfToken(n=>({url:"/codeq/translation-service/translate",method:"POST",credentials:"include",headers:{"X-Flow-Csrftoken":n,"Content-Type":"application/json"},body:JSON.stringify({node:t,sourceLanguage:r})})).then(n=>D.parseJson(n)).catch(n=>D.generalErrorHandler(n))})});function*De(){let e=Ee();yield(0,L.takeLatest)(u.TRANSLATE_DOCUMENT,function*(t){let{nodeContextPath:r,sourceLanguage:n}=t.payload;yield(0,L.put)(g.toggleSyncModalLoading({loading:!0}));let A=yield(0,L.call)(e.translate,r,n);yield(0,L.put)(g.resetSyncModal()),yield(0,L.put)(Oe.actions.ServerFeedback.handleServerFeedback(A))})}var L,Oe,xe=a(()=>{L=i(_e());_();Oe=i(Te());Me()});var Ye={};var Ie=a(()=>{H();pe();_();Ce();xe();V("CodeQ.LostInTranslation.UiSyncButton:DoesSomethingHere",{},e=>{e.get("reducers").set("CodeQ.LostInTranslation.UiSyncButton",{reducer:ie});let o=e.get("containers");o.set("SecondaryToolbar/Right/SyncButton",S),o.set("Modals/TranslationSyncModal",h),e.get("sagas").set("CodeQ.LostInTranslation.UiSyncButton/translateDocument",{saga:De})})});Ie();})();
//# sourceMappingURL=Plugin.js.map
